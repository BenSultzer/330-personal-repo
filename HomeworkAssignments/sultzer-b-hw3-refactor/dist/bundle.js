(()=>{"use strict";var e,t,n,r,o,i,a,c,s,u,l,d,h,p,v,y=function(e,t){return Math.random()*(t-e)+e},m=function(){function e(e,t,n,r,o,i){this.positionX=e,this.positionY=t,this.radius=n,this.color=r,this.speed=o,this.direction=i,this.normalize(i),this.acceleration=1,this.shockwaveType="normal"}return e.prototype.normalize=function(e){var t=Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2));return e[0]/=t,e[1]/=t,e},e.prototype.exertShockwave=function(e,t){var n=Math.sqrt(Math.pow(this.positionX-e,2)+Math.pow(this.positionY-t,2)),r=new Array(2);r[0]=this.positionX-e,r[1]=this.positionY-t;var o=this.normalize(r);this.direction[0]+=o[0],this.direction[1]+=o[1],"freeze"==this.shockwaveType?this.speed*=15/n:this.speed*=1.5},e.prototype.setShockwaveType=function(e){this.shockwaveType=e},e.prototype.setGravity=function(e){this.acceleration=e},e.prototype.update=function(e){this.direction[1]+=this.acceleration*e,this.positionX+=this.direction[0]*this.speed*e,this.positionY+=this.direction[1]*this.speed*e},e.prototype.draw=function(e){this.drawCircle(e,this.positionX,this.positionY,this.radius,this.color)},e.prototype.drawCircle=function(e,t,n,r,o){e.save(),e.fillStyle=o,e.beginPath(),e.arc(t,n,r,0,2*Math.PI),e.closePath(),e.fill(),e.restore()},e}(),f=function(){function e(e,t,n,r,o){this.positionX=e,this.positionY=t,this.particles=new Array(n),this.particleRadius=r,this.particleColor=o,this.createParticleSystem()}return e.prototype.createParticleSystem=function(){for(var e=0;e<this.particles.length;e++)this.particles[e]=new m(this.positionX,this.positionY,this.particleRadius,this.particleColor,y(100,200),new Array(y(-1,1),y(-1,1)))},e.prototype.update=function(e,t){for(var n=0;n<this.particles.length;n++)this.particles[n].update(t),this.particles[n].draw(e)},e}(),g=0,w=0,S=0,q=-1,b="fountain",T="normal",k=1,M=0,E=0,A="frequency";!function(e){e[e.gain=.5]="gain",e[e.numSamples=256]="numSamples"}(c||(c={}));var L,F,H,P,R=function(e){u.src=e},z={showParticleSystems:!0,showParticles:!0,partyMode:!1,showEmboss:!1},C=document.querySelector("#particle-systems-cb"),N=document.querySelector("#particles-cb"),X=document.querySelector("#party-cb"),x=document.querySelector("#emboss-cb"),Y=function(e){for(var n=e.target.getBoundingClientRect(),r=e.clientX-n.x,o=e.clientY-n.y,i=0;i<t.length;i++)t[i].exertShockwave(r,o)},V=function(e){var t=document.querySelector("#burger"),n=document.querySelector("#nav-links");t.addEventListener("click",(function(){n.classList.toggle("is-active")})),document.querySelector("#fs-button").onclick=function(t){var n;console.log("goFullscreen() called"),(n=e).requestFullscreen?n.requestFullscreen():n.mozRequestFullscreen?n.mozRequestFullscreen():n.mozRequestFullScreen?n.mozRequestFullScreen():n.webkitRequestFullscreen&&n.webkitRequestFullscreen()};var r=document.querySelector("#play-button");r.onclick=function(e){console.log("audioCtx.state before = ".concat(s.state)),"suspended"==s.state&&s.resume(),console.log("audioCtx.state after = ".concat(s.state)),"no"==r.dataset.playing?(u.play(),r.dataset.playing="yes"):(u.pause(),r.dataset.playing="no")};var o=document.querySelector("#volume-slider"),i=document.querySelector("#volume-label");o.oninput=function(e){var t;t=Number(o.value),h.gain.value=t;var n=Math.round(Number(o.value)/2*100);i.innerHTML=n.toString()},o.dispatchEvent(new Event("input"));var a=document.querySelector("#gravity-slider"),c=document.querySelector("#gravity-label");a.oninput=function(e){var t;t=Number(a.value),q=t,c.innerHTML=a.value},a.value="1",a.dispatchEvent(new Event("input"));var l=document.querySelector("#speed-slider"),d=document.querySelector("#speed-label");l.oninput=function(e){var t;t=Number(l.value),k=t,d.innerHTML=l.value},l.value="1",l.dispatchEvent(new Event("input"));var y=document.querySelector("#treble-slider"),m=document.querySelector("#treble-label");y.oninput=function(e){var t;t=Number(y.value),p.gain.setValueAtTime(t,s.currentTime),m.innerHTML=y.value},y.value="0",y.dispatchEvent(new Event("input"));var f=document.querySelector("#bass-slider"),g=document.querySelector("#bass-label");f.oninput=function(e){var t;t=Number(f.value),v.gain.setValueAtTime(t,s.currentTime),g.innerHTML=f.value},f.value="0",f.dispatchEvent(new Event("input"));var w=document.querySelector("#track-select");w.onchange=function(){R(w.value),"yes"==r.dataset.playing&&r.dispatchEvent(new MouseEvent("click"))},C.addEventListener("click",(function(e){z.showParticleSystems=C.checked})),N.addEventListener("click",(function(e){z.showParticles=N.checked})),X.addEventListener("click",(function(e){z.partyMode=X.checked})),x.addEventListener("click",(function(e){z.showEmboss=x.checked}))},B=function(){setTimeout(B,1e3/60),function(c){w=g,S=(g+=1/60)-w,"frequency"==A?i.getByteFrequencyData(a):i.getByteTimeDomainData(a),n.save(),n.fillStyle="black",n.fillRect(0,0,r,o),n.restore();var s=document.querySelector("#play-button");if(c.showParticleSystems){var u=(r-4*a.length-10)/a.length;n.save();for(var l=0;l<a.length;l++)(M+=1/60)>=1.3&&(e[l]=new f(5+l*(u+4),356-a[l],5,(256-a[l]+20)/10,"rgba(50, 50, 50, 0.75)"),M=0);if("yes"==s.dataset.playing)for(l=0;l<e.length;l++)e[l].update(n,S);n.restore()}if(c.showParticles){for(n.save(),l=0;l<a.length;l++)if((E+=1/60)>=3){var d=void 0,h=void 0;"fountain"==b?(d=new Array(y(-1,1),y(-1,1)),h=(100+a[l])*k):(d=new Array(Math.sin(3*g),-1),h=(200+a[l])*k),t[l]=new m(r/2,o/2,(256-a[l]+20)/10,"rgba(".concat(175+a[l],", 0, 0, 0.75)"),h,d),t[l].setGravity(q),E=0}if("yes"==s.dataset.playing)for(l=0;l<t.length;l++)t[l].setShockwaveType(T),t[l].update(S),t[l].draw(n);n.restore()}var p=n.getImageData(0,0,r,o),v=p.data,L=v.length,F=p.width;for(l=0;l<L;l+=4)if(c.partyMode&&(v[l]+=100*Math.sin(10*g),v[l+1]+=100*Math.sin(g),v[l+2]+=100*Math.sin(g)),-1==q){var H=v[l],P=v[l+1],R=v[l+2];v[l]=255-H,v[l+1]=255-P,v[l+2]=255-R}if(c.showEmboss)for(l=0;l<L;l++)l%4!=3&&(v[l]=127+2*v[l]-v[l+4]-v[l+4*F]);n.putImageData(p,0,0)}(z)};console.log("startUp() called"),function(){var y;y=window.AudioContext,s=new y,u=new Audio,R("media/New Adventure Theme.mp3"),l=s.createMediaElementSource(u),(d=s.createAnalyser()).fftSize=c.numSamples,(h=s.createGain()).gain.value=c.gain,p=function(e){var t=e.createBiquadFilter();return t.type="highshelf",t.frequency.setValueAtTime(1e3,e.currentTime),t.gain.setValueAtTime(0,e.currentTime),t}(s),v=function(e){var t=e.createBiquadFilter();return t.type="lowshelf",t.frequency.setValueAtTime(1e3,e.currentTime),t.gain.setValueAtTime(0,e.currentTime),t}(s),l.connect(p),p.connect(v),v.connect(d),d.connect(h),h.connect(s.destination),console.log("init called");var g,w=document.querySelector("canvas");V(w),function(c,s){n=c.getContext("2d"),r=c.width,o=c.height,i=s,a=new Uint8Array(i.fftSize/2),e=new Array(a.length);for(var u=0;u<e.length;u++)e[u]=new f(0,0,0,0,"white");for(t=new Array(a.length),u=0;u<t.length;u++)t[u]=new m(r/2,o/2,0,"white",0,new Array(0,0))}(w,d),w.addEventListener("click",Y),(g=new XMLHttpRequest).onload=function(e){var t,n=e.target;try{t=JSON.parse(n.responseText)}catch(e){return void(document.querySelector("#app-description").innerHTML="An error occurred loading app set-up data.")}var r=Object.keys(t);L=t[r[0]],F=t[r[1]],H=t[r[2]],P=t[r[3]],document.querySelector("title").innerHTML=L;for(var o=0;o<F.length;o++)"New Adventure Theme"==H[o]?document.querySelector("#track-select").innerHTML+='<option value="media/'.concat(F[o],'" selected>').concat(H[o],"</option>"):document.querySelector("#track-select").innerHTML+='<option value="media/'.concat(F[o],'">').concat(H[o],"</option>");document.querySelector("#app-description").innerHTML=P},g.onerror=function(e){var t=e.target;console.log("In onerror - HTTP Status Code = ".concat(t.status))},g.open("GET","data/av-data.json"),g.send();var S=document.querySelector("#analyser-data-type"),q=document.querySelector("#emitter-type"),k=document.querySelector("#shockwave-type");C.checked=!0,N.checked=!0,X.checked=!1,x.checked=!1,S.value="frequency",S.onchange=function(){var e;e=S.value,A=e},q.value="fountain",q.onchange=function(){var e;e=q.value,b=e},k.value="normal",k.onchange=function(){var e;e=k.value,T=e},B()}()})();
//# sourceMappingURL=bundle.js.map